{"id":"postarchive","script":"//* TITLE Post Archiver **//\r\n//* VERSION 0.5.1 **//\r\n//* DESCRIPTION Never lose a post again. **//\r\n//* DETAILS Post Archiver lets you save posts to your XKit.<br><br>Found a good recipe? Think those hotline numbers on that signal boost post might come in handy in the future?<br><br>Click on the save button, then click on the My Archive button on your sidebar anytime to access those posts. You can also name and categorize posts. **//\r\n//* DEVELOPER STUDIOXENIX **//\r\n//* FRAME false **//\r\n//* BETA false **//\r\n\r\nXKit.extensions.postarchive = new Object({\r\n\r\n\trunning: false,\r\n\r\n\tbutton_icon: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NDQ5RTU4RTU3MjVEMTFFMzkxNjc4NTlFOTA5MTY1RjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NDQ5RTU4RTY3MjVEMTFFMzkxNjc4NTlFOTA5MTY1RjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo0NDlFNThFMzcyNUQxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo0NDlFNThFNDcyNUQxMUUzOTE2Nzg1OUU5MDkxNjVGNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pu91pc8AAACgSURBVHjaYvz//z8D1QDIMGSMLo0Fz8Sln4mBimCEGMaCRawLiKXx6HEC4qVQ9lwg3ocvNm2A+A+OmETGh4GYGUUvjqRRQcCgVzDXE2MYCGzBY5grNp/hM0wIiB9iMagRV6IllAMsgfgnkkF7QeGE0zA0W7GBIqjccyCWwJYjkfUTMgwE1kGTBAM+wxjRDGEkp6ygSQ5gJOC9YZLRAQIMAENzviFg3gnxAAAAAElFTkSuQmCC\",\r\n\tbutton_on: \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTU0NzMyOUU3MjVEMTFFMzkxNjc4NTlFOTA5MTY1RjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTU0NzMyOUY3MjVEMTFFMzkxNjc4NTlFOTA5MTY1RjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFNTQ3MzI5QzcyNUQxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFNTQ3MzI5RDcyNUQxMUUzOTE2Nzg1OUU5MDkxNjVGNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pn1307MAAAC0SURBVHjaYvz//z8DtQBj/hK88thsmgXE6TDOhGiEEiYGKoIRYhgLFrEuIJbGo8cJiJdC2XOBeB8+wzYB8QEgZsZhmAoUHwHig4S8CVJUQ8BHr4E4Aoj/EhNmHUC8FY9h0UD8lJQIiAPiR1jEm4B4N6mx+Q7qlV9IYvughuGMTeQsw4gmfxyIK4G4F4hfQL2HEk4FSxn/44tNdNAHxDZAPAVqIEnpDBsIGvAc8H94ZnSAAAMAwKElB0jQE0QAAAAASUVORK5CYII=\",\r\n\r\n\tapiKey: \"fuiKNFp9vQFvjLNvx4sUwti4Yb5yGutBN4Xh10LXZhhRKjWlV4\",\r\n\r\n\tarchived_posts: new Array,\r\n\tcategories: new Array,\r\n\r\n\tframe_run: function() {\r\n\r\n\t\tif ($(\".btn.like\").length == 0 && $(\".btn.edit\").length == 0) { return; }\r\n\r\n\t\tXKit.tools.init_css(\"postarchive\");\r\n\r\n\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\tvar m_css = \t\"#iframe_controls { width: auto !important; } \" +\r\n\t\t\t\t\"#xkit_postarchive_inblog_button:before {\" +\r\n\t\t\t\t\t\" background-size: auto; \" +\r\n\t\t\t\t\t\" background-position: 50% 50%; \" +\r\n\t\t\t\t\t\" background-repeat: no-repeat; \" +\r\n\t\t\t\t\t\" background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAOCAYAAAAfSC3RAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTQ0NUQ3NjA3Mjg4MTFFMzkxNjc4NTlFOTA5MTY1RjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTQ0NUQ3NjE3Mjg4MTFFMzkxNjc4NTlFOTA5MTY1RjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5NDQ1RDc1RTcyODgxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5NDQ1RDc1RjcyODgxMUUzOTE2Nzg1OUU5MDkxNjVGNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PtuUengAAACQSURBVHjaYvz//z8DOYAJi5gxEP9Hw8bEaCTZRjYglgNiCSzqJKBybHARkB+hmA2Iz//HDc5D1YDVI2sEYRUg/oxF02eoHAMujSAcgkVjCLo6bBpBeDKSpsnY1DDiiEdQIByDsq2A+Be6AphGmG5GJDlRKP0aSQyuDp9GbACujgWHBFlJjijAQqQTMQBAgAEAoAjV0Rb+PnUAAAAASUVORK5CYII=); \" +\r\n\t\t\t\t\"}\" +\r\n\t\t\t\t\".btn.xkit-post-archive-inblog-button-done { background-color: #59982a !important; }\";\r\n\r\n\t\tXKit.tools.add_css(m_css, \"post_archive_in_blog\");\r\n\r\n\t\tvar m_html = \t\"<a id=\\\"xkit_postarchive_inblog_button\\\" onclick=\\\"return false\\\" class=\\\"btn icon no_label\\\">Post Archiver</a>\";\r\n\r\n\t\t$(\".btn.dashboard\").before(m_html);\r\n\r\n\t\tvar post_id = \"\";\r\n\r\n\t\tif ($(\".btn.like\").length > 0) {\r\n\t\t\tpost_id = $(\".btn.like\").attr('data-id');\r\n\t\t} else {\r\n\t\t\tvar postid_start = document.location.href.search(\"&pid=\");\r\n\t\t\tif (postid_start === -1) { return; }\r\n\t\t\tvar postid_end =  document.location.href.indexOf(\"&\", postid_start + 2);\r\n\t\t \tpost_id = document.location.href.substring(postid_start + 5, postid_end);\r\n\t\t}\r\n\r\n\t\tif (XKit.extensions.postarchive.is_post_in_archive(post_id) !== false) {\r\n\r\n\t\t\t$(\"#xkit_postarchive_inblog_button\").addClass(\"xkit-post-archive-inblog-button-done\");\r\n\r\n\t\t}\r\n\r\n\t\t$(\"#xkit_postarchive_inblog_button\").click(function() {\r\n\r\n\t\t\tvar blog_url = $(\"#tumblelog_name\").attr('data-tumblelog-name');\r\n\r\n\t\t\tXKit.iframe.full();\r\n\r\n\t\t\tXKit.extensions.postarchive.archive(post_id, this, true);\r\n\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\trun: function() {\r\n\r\n\t\tthis.running = true;\r\n\r\n\t\tXKit.tools.init_css(\"postarchive\");\r\n\r\n\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\tif (XKit.interface.where().inbox === true) { return; }\r\n\r\n    if ($('#postarchive_ul').length === 0) {\r\n      var xf_html = \t'<ul class=\"controls_section\" id=\"postarchive_ul\">' +\r\n            '<li class=\"section_header selected\">Post Archive</li>' +\r\n            '<li class=\"no_push\" style=\"height: 36px;\"><a href=\"#\" onclick=\"return false;\" id=\"postarchive_view\">' +\r\n              '<div class=\"hide_overflow\" style=\"color: rgba(255, 255, 255, 0.5) !important; font-weight: bold; padding-left: 10px; padding-top: 8px;\">My Archive <span class=\"count\" id=\"postarchive_view_count\" style=\"padding-top: 8px;\">' + XKit.extensions.postarchive.archived_posts.length + '</span></div>' +\r\n            '</a></li>' +\r\n          '</ul>';\r\n\r\n      $(\"ul.controls_section:first\").before(xf_html);\r\n    }\r\n\r\n\t\t$(\"#postarchive_view\").click(function() {\r\n\r\n\t\t\tXKit.extensions.postarchive.view();\r\n\r\n\t\t});\r\n\r\n\t\tif ($(\".post\").length > 0) {\r\n\r\n\t\t\tXKit.interface.create_control_button(\"xkit-postarchive\", this.button_icon, \"Archive this post\", \"\", this.button_on);\r\n\t\t\tXKit.extensions.postarchive.init();\r\n\t\t\tXKit.post_listener.add(\"postarchive\", XKit.extensions.postarchive.do);\r\n\t\t\tXKit.extensions.postarchive.do();\r\n\t\t}\r\n\r\n\t},\r\n\r\n\trender_posts_uncategorized: function() {\r\n\r\n\t\tvar m_post_list_html = \"\";\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\r\n\t\t\tif (typeof XKit.extensions.postarchive.archived_posts[i].category === \"undefined\" || XKit.extensions.postarchive.archived_posts[i].category == \"\") {\r\n\r\n\t\t\t\tvar m_x_list_div = \"<div data-category=\\\"\\\" data-post-id=\\\"\" + XKit.extensions.postarchive.archived_posts[i].post_id + \"\\\" class=\\\"xkit-postarchive-post\\\">\" + XKit.extensions.postarchive.archived_posts[i].title + \"</div>\";\r\n\t\t\t\tm_post_list_html = m_post_list_html + m_x_list_div;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn m_post_list_html;\r\n\r\n\t},\r\n\r\n\trender_posts_on_category: function(category, additional_classes) {\r\n\r\n\t\tvar m_post_list_html = \"\";\r\n\r\n\t\tif (typeof additional_classes === \"undefined\") { additional_classes = \"\"; }\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\r\n\t\t\tif (typeof XKit.extensions.postarchive.archived_posts[i].category !== \"undefined\") {\r\n\r\n\t\t\t\tif (XKit.extensions.postarchive.archived_posts[i].category == category) {\r\n\r\n\t\t\t\t\tvar m_x_list_div = \"<div data-category=\\\"\" + XKit.extensions.postarchive.archived_posts[i].category + \"\\\" data-post-id=\\\"\" + XKit.extensions.postarchive.archived_posts[i].post_id + \"\\\" class=\\\"xkit-postarchive-post \" + additional_classes + \"\\\">\" + XKit.extensions.postarchive.archived_posts[i].title + \"</div>\";\r\n\t\t\t\t\tm_post_list_html = m_post_list_html + m_x_list_div;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn m_post_list_html;\r\n\r\n\t},\r\n\r\n\tshow_items_in_category: function(category_id, show) {\r\n\r\n\t\t$(\".xkit-postarchive-post, .xkit-postarchive-no-posts-index\").each(function() {\r\n\r\n\t\t\tif ($(this).attr('data-category') === category_id) {\r\n\r\n\t\t\t\tif (show !== true) {\r\n\r\n\t\t\t\t\t$(this).addClass(\"xkit-postarchive-hidden-category-item\");\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t$(this).removeClass(\"xkit-postarchive-hidden-category-item\");\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\tXKit.extensions.postarchive.save_category_collapse(category_id, show);\r\n\r\n\t},\r\n\r\n\tsave_category_collapse: function(category_id, show) {\r\n\r\n\t\tif (category_id === \"\") {\r\n\t\t\t// we have a storage bug on chrome.\r\n\t\t\tif (show === true) {\r\n\t\t\t\tXKit.storage.set(\"postarchive\",\"collapse_uncategorized\", \"false\");\r\n\t\t\t} else{\r\n\t\t\t\tXKit.storage.set(\"postarchive\",\"collapse_uncategorized\", \"true\");\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\tif (category_id === XKit.extensions.postarchive.categories[i].id) {\r\n\r\n\t\t\t\tXKit.extensions.postarchive.categories[i].collapsed = !show;\r\n\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tview: function(open_this_id) {\r\n\r\n\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\tif ($(\"#xkit-postarchive-background\").length > 0) {\r\n\r\n\t\t\t$(\"#xkit-postarchive-background\").remove();\r\n\t\t\t$(\"#xkit-postarchive-container\").remove();\r\n\r\n\t\t}\r\n\r\n\t\tif (XKit.extensions.postarchive.archived_posts.length === 0) {\r\n\r\n\t\t\tXKit.window.show(\"No posts yet.\",\"<b>You have no archived posts yet.</b><br/>If you've archived them on another computer, you might need to sync them using XCloud.\",\"error\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-close-message\\\">OK</div>\");\r\n\t\t\t//return;\r\n\r\n\t\t}\r\n\r\n\t\tconsole.log(XKit.extensions.postarchive.archived_posts);\r\n\r\n\t\tvar m_post_list_html = \"\";\r\n\r\n\t\tm_post_list_html = m_post_list_html + \"<div data-category=\\\"\\\" class=\\\"xkit-postarchive-cat-separator-uncategorized xkit-postarchive-cat-separator xkit-pac-opened\\\"><div class=\\\"xkit-postarchive-cat-separator-title\\\">Uncategorized</div></div>\";\r\n\t\tm_post_list_html = m_post_list_html + XKit.extensions.postarchive.render_posts_uncategorized();\r\n\r\n\r\n\t\tif (XKit.extensions.postarchive.categories.length > 0) {\r\n\r\n\t\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\t\tvar m_collapse_class = \"xkit-pac-opened\";\r\n\t\t\t\tvar m_collapse_class_post = \"\";\r\n\r\n\t\t\t\t// alert(XKit.extensions.postarchive.categories[i].title + \"\\n\" + XKit.extensions.postarchive.categories[i].collapsed);\r\n\r\n\t\t\t\tif (XKit.extensions.postarchive.categories[i].collapsed === true) { m_collapse_class = \"\"; m_collapse_class_post = \"xkit-postarchive-hidden-category-item\"; }\r\n\r\n\t\t\t\tm_post_list_html = m_post_list_html + \"<div data-category=\\\"\" + XKit.extensions.postarchive.categories[i].id + \"\\\" class=\\\"xkit-postarchive-cat-separator \" + m_collapse_class + \"\\\"><div class=\\\"xkit-postarchive-cat-separator-title\\\">\" + XKit.extensions.postarchive.categories[i].title + \"</div></div>\";\r\n\r\n\t\t\t\tvar cat_index = XKit.extensions.postarchive.render_posts_on_category(XKit.extensions.postarchive.categories[i].id, m_collapse_class_post);\r\n\r\n\t\t\t\tif (cat_index !== \"\") {\r\n\r\n\t\t\t\t\tm_post_list_html = m_post_list_html + cat_index;\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tm_post_list_html = m_post_list_html + \"<div data-category=\\\"\" + XKit.extensions.postarchive.categories[i].id + \"\\\" class=\\\"xkit-postarchive-no-posts-index \" + m_collapse_class_post + \"\\\">No posts</div>\";\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tvar m_html = \t\"<div id=\\\"xkit-postarchive-background\\\">&nbsp;</div>\" +\r\n\t\t\t\t\"<div id=\\\"xkit-postarchive-container\\\">\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-sidebar\\\" class=\\\"nano\\\">\" +\r\n\t\t\t\t\t\t\"<div id=\\\"xkit-postarchive-sidebar-content\\\" class=\\\"content\\\">\" +\r\n\t\t\t\t\t\t\tm_post_list_html +\r\n\t\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\"<input type=\\\"text\\\" placeholder=\\\"Search archived post titles..\\\" id=\\\"xkit-postarchive-search\\\">\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-export\\\" class=\\\"xkit-button\\\">Export</div>\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-import\\\" class=\\\"xkit-button\\\">Import</div>\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-content\\\" class=\\\"xkit-postarchive-no-post-selected\\\">\" +\r\n\t\t\t\t\t\t\"Select a post from the right to get started.\" +\r\n\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-remove-this\\\" class=\\\"xkit-button hidden\\\">remove</div>\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-recategorize-this\\\" class=\\\"xkit-button hidden\\\">recategorize</div>\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-rename-this\\\" class=\\\"xkit-button hidden\\\">rename</div>\" +\r\n\t\t\t\t\"</div>\";\r\n\r\n\t\t$(\"body\").append(m_html);\r\n\r\n\t\tif ($(\"#xkit-postarchive-sidebar .xkit-postarchive-post\").length > 8) {\r\n\r\n\t\t\t$(\"#xkit-postarchive-sidebar .xkit-postarchive-post:last-child\").css(\"border-bottom\",\"0px\");\r\n\r\n\t\t}\r\n\r\n\t\t$(\".xkit-postarchive-cat-separator\").click(function() {\r\n\r\n\t\t\t$(this).toggleClass(\"xkit-pac-opened\");\r\n\r\n\t\t\tif ($(this).hasClass(\"xkit-pac-opened\")) {\r\n\r\n\t\t\t\tXKit.extensions.postarchive.show_items_in_category($(this).attr('data-category'), true);\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tXKit.extensions.postarchive.show_items_in_category($(this).attr('data-category'), false);\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xkit-postarchive-sidebar\").nanoScroller();\r\n\t\t$(\"#xkit-postarchive-sidebar\").nanoScroller({ scroll: 'top' });\r\n\r\n\t\t$(\"#xkit-postarchive-sidebar  .xkit-postarchive-post\").click(function() {\r\n\r\n\t\t\t$(\"#xkit-postarchive-sidebar  .xkit-postarchive-post\").removeClass(\"selected\");\r\n\r\n\t\t\t$(this).addClass(\"selected\");\r\n\r\n\t\t\tXKit.extensions.postarchive.render_post($(this).attr('data-post-id'));\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xkit-postarchive-background\").click(function() {\r\n\r\n\t\t\t$(\"#xkit-postarchive-background, #xkit-postarchive-container\").fadeOut('fast', function() { $(this).remove(); });\r\n\r\n\t\t});\r\n\r\n\t\tif (typeof open_this_id !== \"undefined\") {\r\n\r\n\t\t\t$(\".xkit-postarchive-post\").each(function() {\r\n\r\n\t\t\t\tif ($(this).attr('data-post-id') === open_this_id) {\r\n\r\n\t\t\t\t\t$(this).trigger(\"click\");\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t\t\r\n\t\t$(\"#xkit-postarchive-export\").bind(\"click\", function() {\r\n\t\t    \r\n\t\t    var m_data = {};\r\n\t\t    \r\n            m_data.posts = XKit.storage.get(\"postarchive\", \"archived_posts\",\"\");\r\n            m_data.categories = XKit.storage.get(\"postarchive\", \"categories\",\"\");\r\n\r\n    \t\tvar m_html = \t\"<div id=\\\"xkit-postarchive-share-code\\\" class=\\\"nano\\\">\" +\r\n\t    \t    \t\t\t\"<div class=\\\"content\\\">\" +\r\n\t\t    \t\t\t\t\"<div id=\\\"xkit-postarchive-share-code-inner\\\">\" +\r\n\t\t\t\t    \t\t\tJSON.stringify(m_data) +\r\n\t    \t\t\t\t\t\"</div>\" +\r\n\t\t    \t\t\t\"</div>\" +\r\n\t\t\t    \t\"</div>\";\r\n\r\n\t\t\tXKit.window.show(\"Export Archive\",\"Copy and paste the following into a file:\" + m_html,\"info\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-export-confirm\\\">OK</div>\");\r\n\r\n            $(\"#xkit-postarchive-share-code\").nanoScroller();\r\n\t\t    $(\"#xkit-postarchive-share-code\").nanoScroller({ scroll: 'top' });\r\n\r\n\t    \t$(\"#xkit-postarchive-share-code\").click(function() { $(this).selectText();});\r\n\r\n\t\t\t$(\"#xkit-postarchive-export-confirm\").click(function() {\r\n\r\n\t\t\t\tXKit.window.close();\r\n\t\t\t\tXKit.extensions.postarchive.view();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\t\t\r\n\t\t$(\"#xkit-postarchive-import\").bind(\"click\", function() { //Import Function\r\n\r\n\t    \tXKit.window.show(\"Import\",\"<b>You can import settings from XKit.</b><br/>Click XKit''s Export button and paste the text below to import your archived posts.<input type=\\\"text\\\" placeholder=\\\"Paste preferences text here.\\\" class=\\\"xkit-textbox\\\" id=\\\"xkit-postarchive-import-words\\\">\",\"question\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-add-words\\\">Import!</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\")\r\n\r\n\t    \t$(\"#xkit-postarchive-replace-on-import\").click(function() {\r\n\t    \t\t$(this).toggleClass(\"selected\");\r\n\t    \t});\r\n\r\n\t    \t$(\"#xkit-postarchive-add-words\").click(function() {\r\n\r\n\t\t\tvar m_to_add = $(\"#xkit-postarchive-import-words\").val();\r\n\r\n\t\t\t    if (m_to_add === \"\" ||$.trim(m_to_add) === \"\") {\r\n\t\t\t\t    XKit.window.close();\r\n\t\t\t\t    XKit.window.show(\"Noodlebops!\", \"m_to_add is being weird?? \" + m_to_add,\"error\",\"<div id=\\\"xkit-close-message\\\" class=\\\"xkit-button default\\\">OK</div>\");\r\n\t\t\t\t    return;\r\n\t\t\t    }\r\n\r\n\t\t    \ttry {\r\n\r\n\t    \t\t\tvar m_obj = JSON.parse(m_to_add);\r\n\t    \t\t\t//XKit.window.show(\"m_obj:\", JSON.stringify(m_obj),\"error\",\"<div id=\\\"xkit-close-message\\\" class=\\\"xkit-button default\\\">OK</div>\");\r\n\t    \t\t\t//return;\r\n\r\n\t    \t\t} catch(e) {\r\n\t    \t\t\talert(\"Invalid/Corrupt JSON object found.\\nImport can not continue.\");\r\n\t    \t\t\treturn;\r\n\t    \t\t}\r\n\t    \t\t\r\n\t    \t\tm_posts = JSON.parse(m_obj.posts);\r\n\t    \t\tm_categories = JSON.parse(m_obj.categories);\r\n\t    \t\t\r\n\t    \t\tXKit.extensions.postarchive.load_posts();\r\n\t    \t\t\r\n\t    \t\tfor (var n=0;n<m_categories.length;n++) {\r\n\t    \t\t    XKit.extensions.postarchive.categories.push(m_categories[n]);\r\n\t\t\t\t\tconsole.log(XKit.extensions.postarchive.categories);\r\n\t\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\t    \t\t}\r\n\t    \t\t\r\n\t    \t\tfor (var i=0;i<m_posts.length;i++) {\r\n\t    \t\t    XKit.extensions.postarchive.archived_posts.push(m_posts[i]);\r\n\t\t\t\t\tconsole.log(XKit.extensions.postarchive.archived_posts);\r\n\t\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\t    \t\t}\r\n\t    \t\t\r\n\t    \t\tXKit.extensions.postarchive.update_sidebar();\r\n\t    \t\t\r\n\t    \t\tXKit.window.show(\"Done!\", \"Your posts should exist!\", \"info\",\"<div id=\\\"xkit-close-message\\\" class=\\\"xkit-button default\\\">OK</div>\");\r\n\t    \t\treturn;\r\n\r\n\t    \t});\r\n\r\n        });\r\n\r\n\t\t$(\"#xkit-postarchive-search\").keyup(function() {\r\n\r\n\t\t\tvar m_value = $(this).val().toLowerCase();\r\n\t\t\tm_value = $.trim(m_value);\r\n\r\n\t\t\tif (m_value === \"\") {\r\n\r\n\t\t\t\t$(\".xkit-postarchive-post\").removeClass(\"xkit-this-post-is-pretty-hidden\");\r\n\t\t\t\t$(\"#xkit-postarchive-not-found\").remove();\r\n\t\t\t\t$(\".xkit-postarchive-cat-separator\").removeClass(\"xkit-this-post-is-pretty-hidden\");\r\n\t\t\t\t$(\".xkit-postarchive-no-posts-index\").removeClass(\"xkit-this-post-is-pretty-hidden\");\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\t$(\".xkit-postarchive-cat-separator\").addClass(\"xkit-this-post-is-pretty-hidden\");\r\n\t\t\t\t$(\".xkit-postarchive-no-posts-index\").addClass(\"xkit-this-post-is-pretty-hidden\");\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar found_count = 0;\r\n\r\n\t\t\t$(\".xkit-postarchive-post\").each(function() {\r\n\r\n\t\t\t\tif ($(this).html().toLowerCase().indexOf(m_value) !== -1) {\r\n\r\n\t\t\t\t\tfound_count++;\r\n\t\t\t\t\t$(this).removeClass(\"xkit-this-post-is-pretty-hidden\");\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t$(this).addClass(\"xkit-this-post-is-pretty-hidden\");\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\tif (found_count == 0){\r\n\r\n\t\t\t\tif ($(\"#xkit-postarchive-not-found\").length == 0) {\r\n\t\t\t\t\t$(\"#xkit-postarchive-sidebar-content\").append(\"<div id=\\\"xkit-postarchive-not-found\\\">Not found.</div>\");\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t\t$(\"#xkit-postarchive-sidebar\").nanoScroller();\r\n\t\t\t$(\"#xkit-postarchive-sidebar\").nanoScroller({ scroll: 'top' });\r\n\r\n\t\t});\r\n\r\n\t\tvar collapse_uncat = XKit.storage.get(\"postarchive\",\"collapse_uncategorized\", \"false\");\r\n\t\tif (collapse_uncat === \"true\" || collapse_uncat === true) {\r\n\r\n\t\t\t// dirty coding.\r\n\t\t\t$(\".xkit-postarchive-cat-separator-uncategorized\").trigger('click');\r\n\r\n\t\t}\r\n\r\n\t},\r\n\r\n\tget_photo: function(data, index, width) {\r\n\r\n\t\tfor (var i=0;i<data.photos[index].alt_sizes.length;i++) {\r\n\t\t\tif (parseInt(data.photos[index].alt_sizes[i].width) === parseInt(width)) {\r\n\t\t\t\treturn data.photos[index].alt_sizes[i].url;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data.photos[index].alt_sizes[0].url;\r\n\r\n\t},\r\n\r\n\tget_photo_height: function(data, index, width) {\r\n\r\n\t\tfor (var i=0;i<data.photos[index].alt_sizes.length;i++) {\r\n\t\t\tif (parseInt(data.photos[index].alt_sizes[i].width) === parseInt(width)) {\r\n\t\t\t\treturn data.photos[index].alt_sizes[i].height;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data.photos[index].alt_sizes[0].height;\r\n\r\n\t},\r\n\r\n\tparse_item: function(data, username) {\r\n\r\n\t\tconsole.log(data);\r\n\r\n\t\tvar m_html = \"<li class=\\\"post_container\\\">\";\r\n\t\tvar post_class = \"\";\r\n\t\tvar additional_classes_for_post = \"\";\r\n\r\n\t\tvar post_tags = \"\";\r\n\t\tvar post_contents = \"\";\r\n\r\n\t\tif (data.type === \"text\") {\r\n\r\n\t\t\tpost_class = \"is_regular\";\r\n\r\n\t\t\tif (data.title !== \"\" && data.title !== null) {\r\n\t\t\t\tpost_contents = post_contents + \"<div class=\\\"post_title\\\">\" + data.title + \"</div>\";\r\n\t\t\t}\r\n\r\n\t\t\tif (data.body !== \"\" && data.body !== null) {\r\n\t\t\t\tpost_contents = post_contents + \"<div class=\\\"post_body\\\">\" + data.body + \"</div>\";\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (data.type === \"quote\") {\r\n\r\n\t\t\tpost_class = \"is_quote\";\r\n\r\n\t\t\tif (data[\"text\"] !== \"\" && data[\"text\"] !== null) {\r\n\t\t\t\tpost_contents = post_contents + '<div class=\"post_title medium\"><span class=\"quote\">\"' + data[\"text\"] + '\"</span></div>';\r\n\t\t\t}\r\n\r\n\t\t\tif (data[\"source\"] !== \"\" && data[\"source\"] !== null) {\r\n\t\t\t\tpost_contents = post_contents + '<div class=\"post_body\"><table class=\"quote_source_table\"><tbody><tr><td valign=\"top\" class=\"quote_source_mdash\">&nbsp;</td><td valign=\"top\" class=\"quote_source\">- ' + data.source + '</td></tr></tbody></table></div>';\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (data.type === \"link\") {\r\n\r\n\t\t\tpost_class = \"is_link\";\r\n\r\n\t\t\tif (data.link_image !== \"\" && data.link_image !== null && typeof data.link_image !== \"undefined\") {\r\n\r\n\t\t\t\tpost_contents = post_contents + '<div class=\"post_media\"><div class=\"link_button clickable\"><div class=\"link_thumbnail_container\"><a href=\"' + data.url + '\" target=\"_blank\" class=\"link_thumbnail_click\"><img class=\"link_thumbnail\" src=\"' + data.link_image + '\" alt=\"\"></a></div><div class=\"link_text_container\"><div class=\"link_text_outer\"><div class=\"link_text\"><a href=\"' + data.url + '\" target=\"_blank\" class=\"link_title\">' + data.title + '</a><a href=\"' + data.url + '\" target=\"_blank\" class=\"link_source\">' + data.url + '</a></div></div></div></div></div>';\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tvar link_title = data.url;\r\n\r\n\t\t\t\tif (data.title !== \"\" && data.title !== null && typeof data.title !== \"undefined\") {\r\n\r\n\t\t\t\t\tvar link_title = data.title;\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tpost_contents = post_contents + '<div class=\"post_media\"><div class=\"link_button clickable\"><div class=\"link_text_container\"><div class=\"link_text_outer\"><div class=\"link_text\"><a href=\"' + data.url + '\" target=\"_blank\" class=\"link_title\">' + link_title + '</a></div></div></div></div></div>';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tif (data.description !== \"\" && data.description !== null) {\r\n\r\n\t\t\t\tpost_contents = post_contents + '<div class=\"post_body\">' + data.description + '</div>';\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (data.type === \"answer\") {\r\n\r\n\t\t\tpost_class = \"is_note\";\r\n\r\n\t\t\tpost_contents = post_contents + '<div class=\"post_body\"><div class=\"note_item\"><div class=\"text\"><p class=\"asker\"><span class=\"name\">' + data.asking_name + '</span><span>&nbsp;asked:</span></p><p>' + data.question + '</p></div><div class=\"nipple\"></div></div><div class=\"avatar\"><img src=\"http://assets.tumblr.com/images/anonymous_avatar_96.gif\" alt=\"\" width=\"40\" height=\"40\"></div><div class=\"answer post_info\">' + data.answer + '</div></div>';\r\n\r\n\t\t}\r\n\r\n\t\tif (data.type === \"video\") {\r\n\r\n\t\t\tpost_class = \"is_video\";\r\n\r\n\t\t\tvar m_post_inner_html = \"\"; // data[\"player\"][2].embed_code; // '<div class=\"view-on-dash-not-supported\">' + data.type + ' posts are not currently supported.</div>';\r\n\r\n\t\t\tvar last_width = 0;\r\n\t\t\tfor (var obj in data[\"player\"]) {\r\n\t\t\t\tif (data[\"player\"][obj].width > last_width && data[\"player\"][obj].width <= 500) {\r\n\t\t\t\t\tm_post_inner_html = data[\"player\"][obj].embed_code;\r\n\t\t\t\t\tlast_width = data[\"player\"][obj].width;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t\tpost_contents = post_contents + \"<div class=\\\"post_media\\\">\" + m_post_inner_html + \"</div>\";\r\n\r\n\t\t\tif (data[\"caption\"] !== \"\" && data[\"caption\"] !== null) {\r\n\t\t\t\tpost_contents = post_contents + \"<div class=\\\"post_body\\\">\" + data[\"caption\"] + \"</div>\";\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (data.type === \"audio\") {\r\n\r\n\t\t\tpost_class = \"is_audio\";\r\n\r\n\t\t\tpost_contents = post_contents + \"<div class=\\\"post_media\\\">\" + data.embed + \"</div>\";\r\n\r\n\t\t\tif (data[\"caption\"] !== \"\" && data[\"caption\"] !== null) {\r\n\t\t\t\tpost_contents = post_contents + \"<div class=\\\"post_body\\\">\" + data[\"caption\"] + \"</div>\";\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (data.type === \"photo\") {\r\n\r\n\t\t\tpost_class = \"is_photo\";\r\n\r\n\t\t\t//var m_post_inner_html = '<img class=\"image\" width=\"500\" alt=\"\" src=\"' + data[\"photo-url-500\"] + '\" data-thumbnail=\"' + data[\"photo-url-100\"] + '\">';\r\n\r\n\t\t\tif (data.photos.length === 1) { post_class = \"is_photo\"; }else {post_class = \"is_photoset\"; }\r\n\r\n\t\t\tvar m_post_inner_html = \"\";\r\n\r\n\t\t\tif (data.photos.length === 1) {\r\n\r\n\t\t\t\tm_post_inner_html = '<img class=\"image\" width=\"500\" alt=\"\" src=\"' + XKit.extensions.postarchive.get_photo(data, 0, \"500\") + '\" data-thumbnail=\"' + XKit.extensions.postarchive.get_photo(data, 0, \"100\") + '\">';\r\n\r\n\t\t\t} else {\r\n\r\nvar rows = [];\r\n\r\n\t\t\t\tfor (var i=0;i<data.photoset_layout.length;i++) {\r\n\t\t\t\t\trows.push(data.photoset_layout[i]);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tm_post_inner_html = \"<div class=\\\"photoset\\\" style=\\\"margin-bottom: 11px;\\\">\";\r\n\r\n\t\t\t\tvar current_photo = 0;\r\n\r\n\t\t\t\tfor (var i=0;i<rows.length;i++) {\r\n\r\n\t\t\t\t\tvar shortest = 0;\r\n\t\t\t\t\tvar m_width = 500 / rows[i];\r\n\r\n\t\t\t\t\t// Calculate the shortest!\r\n\t\t\t\t\tvar m_temp_photo = current_photo;\r\n\r\n\t\t\t\t\tif (rows[i] >= 2) {\r\n\r\n\t\t\t\t\t\tfor (var m=1;m<rows[i];m++){\r\n\r\n\t\t\t\t\t\t\tvar m_height = (m_width * XKit.extensions.postarchive.get_photo_height(data, m_temp_photo, \"500\")) / 500;\r\n\r\n\t\t\t\t\t\t\tif (m_height <= shortest ||shortest === 0) {\r\n\t\t\t\t\t\t\t\tshortest = m_height;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tm_temp_photo++;\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\tshortest = XKit.extensions.postarchive.get_photo_height(data, m_temp_photo, \"500\");\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar in_row_html = \"\";\r\n\r\n\t\t\t\t\tfor (var x=0;x<rows[i];x++) {\r\n\r\n\t\t\t\t\t\tvar m_height = (m_width * XKit.extensions.postarchive.get_photo_height(data, current_photo, \"500\")) / 500;\r\n\t\t\t\t\t\tvar margin_top = 0;\r\n\r\n\t\t\t\t\t\tconsole.log(\"m_height = \" + m_height + \"\\nshortest = \" + shortest);\r\n\r\n\t\t\t\t\t\tif (m_height > shortest) {\r\n\t\t\t\t\t\t\tmargin_top = (m_height - shortest) / 2;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tin_row_html = in_row_html + '<a href=\"' + XKit.extensions.postarchive.get_photo(data, current_photo, \"500\") + '\" class=\"photoset_photo xkit-postarchive-photoset-photo\" onclick=\"return false;\" id=\"photoset_link_' + data.id + '_' + current_photo + '\">';\r\n\t\t\t\t\t\tin_row_html = in_row_html + '<img style=\"margin-top: -' + margin_top + 'px;\" class=\"photoset_photo\" width=\"' + m_width + '\" alt=\"\" src=\"' + XKit.extensions.postarchive.get_photo(data, current_photo, \"500\") + '\" data-thumbnail=\"' + XKit.extensions.postarchive.get_photo(data, current_photo, \"100\") + '\">';\r\n\t\t\t\t\t\tin_row_html = in_row_html + '</a>';\r\n\r\n\t\t\t\t\t\tcurrent_photo++;\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tm_post_inner_html = m_post_inner_html + \"<div class=\\\"photoset_row photoset_row_\" + rows[i] + \"\\\" style=\\\"height: \" + shortest + \"px;\\\">\" + in_row_html + \"</div>\";\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tm_post_inner_html = m_post_inner_html + \"</div>\";\r\n\r\n\t\t\t\t// m_post_inner_html = '<div class=\"view-on-dash-not-supported\">Photosets are not currently supported.</div>';\r\n\r\n\t\t\t}\r\n\r\n\t\t\tpost_contents = post_contents + \"<div class=\\\"post_media\\\">\" + m_post_inner_html + \"</div>\";\r\n\r\n\t\t\tif (data[\"caption\"] !== \"\" && data[\"caption\"] !== null) {\r\n\t\t\t\tpost_contents = post_contents + \"<div class=\\\"post_body\\\">\" + data[\"caption\"] + \"</div>\";\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (typeof data.tags !== \"undefined\") {\r\n\r\n\t\t\tpost_tags = \"<div class=\\\"post_tags\\\"><div class=\\\"post_tags_inner\\\">\"\r\n\r\n\t\t\tfor (var i=0;i<data.tags.length;i++) {\r\n\r\n\t\t\t\tvar fixed_tag_url = XKit.tools.replace_all(data.tags[i], + \" \", \"-\");\r\n\t\t\t\tpost_tags = post_tags + \"<a class=\\\"post_tag\\\" href=\\\"http://tumblr.com/tagged/\" + fixed_tag_url + \"\\\">#\" + data.tags[i] + \"</a>\";\r\n\r\n\t\t\t}\r\n\r\n\t\t\tpost_tags = post_tags + \"</div></div>\";\r\n\r\n\t\t}\r\n\r\n\t\tvar source_div = \"\";\r\n\t\tvar reblog_div = \"\";\r\n\r\n\t\tif (data.source_url !== \"\" && typeof data.source_url !== \"undefined\") {\r\n\r\n\t\t\tsource_div = '<div class=\"post_source\"><a class=\"post_source_link\" target=\"_blank\" href=\"' + data.source_url + '\" title=\"' + data.source_title + '\">' + data.source_title + '</a><span class=\"post_source_name_prefix\">Source: </span></div>';\r\n\r\n\t\t}\r\n\r\n\t\tif (data.reblogged_from_id !== \"\" && typeof data.reblogged_from_id !== \"undefined\") {\r\n\r\n\t\t\treblog_div = '<span class=\"reblog_source\"><span class=\"reblog_icon\" title=\"' + username + ' reblogged ' + data.reblogged_from_name + '\">reblogged</span><a target=\"_BLANK\" title=\"' + data.reblogged_from_name + '\" href=\"' + data.reblogged_from_url + '\" style=\"\">' + data.reblogged_from_name + '</a></span>';\r\n\r\n\t\t}\r\n\r\n\t\tm_html = m_html + \"<div class=\\\"xkit-dont-run-extensions post post_full \" + post_class + \" same_user_as_last with_permalink no_source xkit_view_on_dash_post\\\" id=\\\"post_\" + data.id + \"\\\"  data-post-id='\" + data.id + \"' data-root-id='\" + data.id + \"' data-tumblelog-name='\" + username + \"' data-reblog-key='\" + data.reblog_key + \"' data-type='\" + data.type + \"'>\" +\r\n\t\t\t\t\t\"<div class=\\\"post_wrapper\\\">\" +\r\n\t\t\t\t\t\t\"<div class=\\\"post_header\\\">\" +\r\n\t\t\t\t\t\t\t\"<div class=\\\"post_info\\\">\" +\r\n\t\t\t\t\t\t\t\t\"<img src=\\\"http://api.tumblr.com/v2/blog/\" + data.blog_name + \".tumblr.com/avatar/24\\\" class=\\\"xkit-post-archive-avatar\\\"><span style=\\\"font-weight:normal; margin-right: 8px;\\\">Archived from:</span><a target=\\\"_BLANK\\\" href=\\\"\" + data.post_url + \"\\\">\" + data.blog_name + \"</a>\" +\r\n\t\t\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\t\tsource_div +\r\n\t\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\t\"<div class=\\\"post_content clearfix\\\">\" +\r\n\t\t\t\t\t\t\t\"<div class=\\\"post_content_inner clearfix\\\">\" +\r\n\t\t\t\t\t\t\t\t\"<div class=\\\"post_container\\\">\" +\r\n\t\t\t\t\t\t\t\t\tpost_contents +\r\n\t\t\t\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\t\tpost_tags +\r\n\t\t\t\t\t\"</div>\";\r\n\r\n\t\t//alert(\"<a style=\\\"display: none;\\\" class=\\\"post_permalink\\\" id=\\\"permalink_\" + data.id + \"\\\" href=\\\"\" + data.post_url + \"\\\" target=\\\"_blank\\\" title=\\\"View post - whatever\\\"></a>\");\r\n\t\tm_html = m_html + \"</div>\";\r\n\t\tm_html = m_html + \"</li>\";\r\n\r\n\t\t//console.log(m_html);\r\n\t\treturn m_html;\r\n\r\n\t},\r\n\r\n\tcurrent_post_id: \"\",\r\n\r\n\trender_post: function(post_id) {\r\n\r\n\t\tvar m_post = XKit.extensions.postarchive.get_from_archive(post_id);\r\n\t\tif (m_post === false) { alert(\"Can not fetch post (error PAC-302)\"); return; }\r\n\r\n\t\tvar post_obj = \"\";\r\n\t\tif (m_post.post.substring(0, 11) === \"XKIT-BTOA!!\") {\r\n\t\t\t//alert(\"bfore: \" + m_post.post);\r\n\t\t\tvar tmp_dt = m_post.post.substring(11, m_post.post.length);\r\n\t\t\t//alert(\"after: \" + m_post.post);\r\n\t\t\tpost_obj = JSON.parse(decodeURIComponent(escape(window.atob(tmp_dt))));\r\n\t\t} else {\r\n\t\t\ttry {\r\n\t\t\t\tpost_obj = JSON.parse(m_post.post);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tpost_obj = JSON.parse(decodeURIComponent(escape(window.atob(m_post.post))));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\t\tconsole.log(post_obj);\r\n\r\n\t\tXKit.extensions.postarchive.current_post_id = post_id;\r\n\r\n\t\t$(\"#xkit-postarchive-content\").removeClass(\"xkit-postarchive-no-post-selected\").html(XKit.extensions.postarchive.parse_item(post_obj, \"xenix\"));\r\n\r\n\t\t$(\"#xkit-postarchive-remove-this\").removeClass(\"hidden\");\r\n\t\t$(\"#xkit-postarchive-recategorize-this\").removeClass(\"hidden\");\r\n\t\t$(\"#xkit-postarchive-rename-this\").removeClass(\"hidden\");\r\n\r\n\t\t$(\"#xkit-postarchive-remove-this\").unbind(\"click\");\r\n\t\t$(\"#xkit-postarchive-remove-this\").bind(\"click\", function() {\r\n\r\n\t\t\tXKit.window.show(\"Remove\",\"You sure you want to remove this?\",\"warning\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-remove-item-confirm\\\">Remove</div><div id=\\\"xkit-close-message\\\" class=\\\"xkit-button\\\">Cancel</div>\");\r\n\r\n\t\t\t$(\"#xkit-postarchive-remove-item-confirm\").click(function() {\r\n\r\n\t\t\t\tXKit.extensions.postarchive.remove_from_archive(post_id);\r\n\t\t\t\tXKit.window.close();\r\n\t\t\t\tXKit.extensions.postarchive.view();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xkit-postarchive-rename-this\").unbind(\"click\");\r\n\t\t$(\"#xkit-postarchive-rename-this\").bind(\"click\", function() {\r\n\r\n\t\t\tXKit.window.show(\"Rename This Post\", \"<b>Title:</b><input type=\\\"text\\\" value=\\\"\" + m_post.title + \"\\\"maxlength=\\\"150\\\" placeholder=\\\"Enter a title (example: 'hotline phone list')\\\" class=\\\"xkit-textbox\\\" id=\\\"xkit-postarchive-title\\\">\", \"question\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-save-new-name\\\">Save</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\");\r\n\r\n\t\t\t$(\"#xkit-postarchive-save-new-name\").click(function() {\r\n\r\n\t\t\t\tvar m_title = $(\"#xkit-postarchive-title\").val();\r\n\r\n\t\t\t\tif ($.trim(m_title) === \"\") { XKit.window.close(); }\r\n\r\n\t\t\t\tXKit.extensions.postarchive.rename_archived_post(post_id, m_title);\r\n\r\n\t\t\t\t$(\".xkit-postarchive-post\").each(function() {\r\n\r\n\t\t\t\t\tif ($(this).attr('data-post-id') === post_id) {\r\n\r\n\t\t\t\t\t\t$(this).html(m_title);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t\tXKit.window.close();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xkit-postarchive-recategorize-this\").unbind(\"click\");\r\n\t\t$(\"#xkit-postarchive-recategorize-this\").bind(\"click\", function() {\r\n\r\n\t\t\tif (XKit.extensions.postarchive.categories.length === 0) {\r\n\r\n\t\t\t\tXKit.window.show(\"No categories\",\"You have no categories. You can add some from the Post Archiver control panel.\",\"warning\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-close-message\\\">OK</div>\");\r\n\t\t\t\treturn;\r\n\r\n\t\t\t}\r\n\r\n\t\t\tvar m_categories = \"\";\r\n\r\n\t\t\tif (XKit.extensions.postarchive.categories.length === 0) {\r\n\r\n\t\t\t\tm_categories = \"You have no categories. You can add some from XKit Control Panel > Post Archiver > Add Category.\";\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\t\t\tm_categories = m_categories + \"<option value=\\\"\" + XKit.extensions.postarchive.categories[i].id + \"\\\">\" + XKit.extensions.postarchive.categories[i].title + \"</div>\";\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\tm_categories = \"<option value=\\\"\\\">Uncategorized</option>\" + m_categories;\r\n\t\t\t\tm_categories = \"<select id=\\\"xkit-postarchive-category\\\">\" + m_categories + \"</select>\";\r\n\r\n\t\t\t}\r\n\r\n\t\t\tXKit.window.show(\"Recategorize This Post\", \"<b>Category:</b>\" + m_categories, \"question\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-save-new-category\\\">Save</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\");\r\n\r\n\t\t\t$(\"#xkit-postarchive-save-new-category\").click(function() {\r\n\r\n\t\t\t\tXKit.extensions.postarchive.recategorize_archived_post(post_id, $(\"#xkit-postarchive-category\").val());\r\n\r\n\t\t\t\t// to-do refresh view.\r\n\t\t\t\tXKit.extensions.postarchive.view(post_id);\r\n\r\n\t\t\t\tXKit.window.close();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(\"#xkit-postarchive-content\").find(\".post\").css(\"display\",\"block\").css(\"visibility\",\"visible\");\r\n\r\n\t\tXKit.tools.add_function(function() {\r\n\t\t\tTumblr.Events.trigger(\"posts:load\");\r\n\t\t}, true, \"\");\r\n\r\n\t\tXKit.post_listener.check(true);\r\n\r\n\t},\r\n\r\n\tload_posts: function() {\r\n\r\n\t\t//console.log(\"Post Archiver: Loading posts...\");\r\n\r\n\t\tvar m_storage = XKit.storage.get(\"postarchive\", \"archived_posts\",\"\");\r\n\r\n\t\t//console.log(\"Post Archiver storage result:\\n\\n\" + m_storage + \"\\n\\n\");\r\n\r\n\t\tif (m_storage !== \"\") {\r\n\t\t\ttry {\r\n\t\t\t\tXKit.extensions.postarchive.archived_posts = JSON.parse(m_storage);\r\n\t\t\t\tconsole.log(\" --- Storage loaded successfully.. (\" + XKit.extensions.postarchive.archived_posts.length + \" items)\");\r\n\t\t\t} catch(e) {\r\n\t\t\t\tXKit.extensions.postarchive.archived_posts = new Array();\r\n\t\t\t\tXKit.notifications.add(\"Post Archiver storage error: POSTA-101<br/>Please refresh the page and/or file a bug report.\", \"error\");\r\n\t\t\t\tconsole.log(\" --- Storage Error!! \" + e.message);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tconsole.log(\" --- Storage is empty\");\r\n\t\t\tXKit.extensions.postarchive.archived_posts = new Array();\r\n\t\t}\r\n\r\n\t\tm_storage = XKit.storage.get(\"postarchive\", \"categories\",\"\");\r\n\r\n\t\tif (m_storage !== \"\") {\r\n\t\t\ttry {\r\n\t\t\t\tXKit.extensions.postarchive.categories = JSON.parse(m_storage);\r\n\t\t\t} catch(e) {\r\n\t\t\t\tXKit.extensions.postarchive.categories = new Array();\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tXKit.extensions.postarchive.categories = new Array();\r\n\t\t}\r\n\r\n\t\t//console.log(\"Load result:\");\r\n\t\t//console.log(XKit.extensions.postarchive.archived_posts);\r\n\r\n\t},\r\n\r\n\tsave_posts: function() {\r\n\r\n\t\ttry {\r\n\t\t\tconsole.log(\"Trying to save \" + XKit.extensions.postarchive.archived_posts.length + \" posts..\");\r\n\t\t\tconsole.log(JSON.stringify(XKit.extensions.postarchive.archived_posts));\r\n\t\t\tXKit.storage.set(\"postarchive\", \"archived_posts\", JSON.stringify(XKit.extensions.postarchive.archived_posts));\r\n\t\t\tXKit.storage.set(\"postarchive\", \"categories\", JSON.stringify(XKit.extensions.postarchive.categories));\r\n\t\t} catch(e) {\r\n\t\t\tXKit.window.show(\"Unable to save data\",\"Post Archiver could not save data<br/><br/>Error:<br/>\" + e.message, \"error\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-close-message\\\">OK</div>\");\r\n\t\t\talert(\"Can't save data:\\n\" + e.message);\r\n\t\t}\r\n\t},\r\n\r\n\tinit: function() {\r\n\r\n\t\t$(document).on(\"click\", \".xkit-postarchive\", function(event) {\r\n\t\t\tvar post_id = $(this).attr('data-post-id');\r\n\t\t\tXKit.extensions.postarchive.archive(post_id, this);\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tis_post_in_archive: function(post_id) {\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\t\t\tif (XKit.extensions.postarchive.archived_posts[i].post_id == post_id) {\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tget_from_archive: function(post_id) {\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\t\t\tif (XKit.extensions.postarchive.archived_posts[i].post_id == post_id) {\r\n\t\t\t\treturn XKit.extensions.postarchive.archived_posts[i];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tremove_from_archive: function(post_id) {\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\t\t\tif (XKit.extensions.postarchive.archived_posts[i].post_id == post_id) {\r\n\t\t\t\tXKit.extensions.postarchive.archived_posts.splice(i, 1);\r\n\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\trename_archived_post: function(post_id, title) {\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\t\t\tif (XKit.extensions.postarchive.archived_posts[i].post_id == post_id) {\r\n\t\t\t\tXKit.extensions.postarchive.archived_posts[i].title = title;\r\n\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\trecategorize_archived_post: function(post_id, category) {\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\t\t\tif (XKit.extensions.postarchive.archived_posts[i].post_id == post_id) {\r\n\t\t\t\tXKit.extensions.postarchive.archived_posts[i].category = category;\r\n\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tupdate_sidebar: function() {\r\n\r\n\t\t$(\"#postarchive_view_count\").html(XKit.extensions.postarchive.archived_posts.length);\r\n\r\n\t},\r\n\r\n\tarchive: function(post_id, obj, in_blog_mode) {\r\n\r\n\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\tif (XKit.interface.where().drafts === true) { XKit.window.show(\"Oops\",\"Unfortunately, Post Archiver does not yet support archiving from the drafts, but I'm working on it. Thank you for your patience.\",\"error\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-close-message\\\">OK</div>\"); return; }\r\n\r\n\t\tif (XKit.extensions.postarchive.is_post_in_archive(post_id) !== false) {\r\n\r\n\t\t\tXKit.window.show(\"Already in archive.\",\"Would you like to remove this post from the archive?\", \"question\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-remove-from-archive\\\">Yes, remove from archive</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\");\r\n\r\n\t\t\t$(\"#xkit-postarchive-remove-from-archive\").click(function() {\r\n\r\n\t\t\t\tXKit.window.close();\r\n\r\n\t\t\t\tXKit.extensions.postarchive.remove_from_archive(post_id);\r\n\r\n\t\t\t\tif (!in_blog_mode) {\r\n\r\n\t\t\t\t\tXKit.interface.completed_control_button(obj, false);\r\n\r\n\t\t\t\t\tXKit.notifications.add(\"Post removed from Archive.\", \"ok\");\r\n\r\n\t\t\t\t\tXKit.extensions.postarchive.update_sidebar();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\t$(obj).removeClass(\"xkit-post-archive-inblog-button-done\");\r\n\t\t\t\t\tsetTimeout(function() { XKit.iframe.restore();\t}, 300);\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\treturn;\r\n\r\n\t\t}\r\n\r\n\t\tvar m_categories = \"\";\r\n\r\n\t\tif (XKit.extensions.postarchive.categories.length === 0) {\r\n\r\n\t\t\tm_categories = \"You have no categories. You can add some from XKit Control Panel > Post Archiver > Add Category.\";\r\n\r\n\t\t} else {\r\n\r\n\t\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\t\tm_categories = m_categories + \"<option value=\\\"\" + XKit.extensions.postarchive.categories[i].id + \"\\\">\" + XKit.extensions.postarchive.categories[i].title + \"</div>\";\r\n\r\n\t\t\t}\r\n\r\n\t\t\tm_categories = \"<option value=\\\"\\\">Uncategorized</option>\" + m_categories;\r\n\t\t\tm_categories = \"<select id=\\\"xkit-postarchive-category\\\">\" + m_categories + \"</select>\";\r\n\r\n\t\t}\r\n\r\n\t\tvar m_title = \"\";\r\n\t\tif ($(\"#post_\" + post_id).length > 0) {\r\n\r\n\t\t\tvar dpostobj = $(\"#post_\" + post_id);\r\n\r\n\t\t\tif ($(dpostobj).find(\".post_title\").length > 0) {\r\n\r\n\t\t\t\tm_title = $(dpostobj).find(\".post_title\").text();\r\n\r\n\t\t\t} else {\r\n\r\n\t\t\t\tif ($(dpostobj).find(\".post_body\").length > 0) {\r\n\r\n\t\t\t\t\tm_title = $(dpostobj).find(\".post_body\").text();\r\n\r\n\t\t\t\t} else {\r\n\r\n\t\t\t\t\tif ($(dpostobj).find(\".track_name\").length > 0) {\r\n\r\n\t\t\t\t\t\tm_title = $(dpostobj).find(\".track_name\").text();\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\tif (m_title.length > 30) {\r\n\t\t\tm_title = m_title.substring(0,29) + \"...\";\r\n\t\t}\r\n\r\n\t\tXKit.window.show(\"Archive This Post\", \"<b>Title:</b><input type=\\\"text\\\" value=\\\"\" + m_title + \"\\\" maxlength=\\\"150\\\" placeholder=\\\"Enter a title (example: 'hotline phone list')\\\" class=\\\"xkit-textbox\\\" id=\\\"xkit-postarchive-title\\\"><b>Category:</b><br/>\" + m_categories, \"question\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-save\\\">Save</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\");\r\n\r\n\t\t$(\"#xkit-postarchive-save\").click(function() {\r\n\r\n\t\t\tvar m_title = $(\"#xkit-postarchive-title\").val();\r\n\r\n\t\t\tif ($(this).hasClass(\"disabled\")) { return; }\r\n\r\n\t\t\tif ($.trim(m_title) === \"\") {\r\n\t\t\t\talert(\"Please enter a title for this post.\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tvar m_category = \"\";\r\n\r\n\t\t\tif ($(\"#xkit-postarchive-category\").length > 0) {\r\n\r\n\t\t\t\tm_category = $(\"#xkit-postarchive-category\").val();\r\n\r\n\t\t\t}\r\n\r\n\t\t\tXKit.extensions.postarchive.save_using_api(post_id, obj, m_title, m_category, in_blog_mode);\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tsave_using_api: function(post_id, obj, title, m_category, in_blog_mode) {\r\n\r\n\t\t$(\"#xkit-postarchive-save\").addClass(\"disabled\");\r\n\r\n\t\tvar m_post = XKit.interface.find_post(post_id);\r\n\t\tvar blog_url = m_post.owner;\r\n\t\t\r\n\t\tif (blog_url == undefined) {\r\n\t\t    blog_url = window.location.href.split('%2F')[2].split('.')[0];\r\n\t\t}\r\n\r\n\t\tvar api_url = \"http://api.tumblr.com/v2/blog/\" + blog_url + \".tumblr.com/posts/?api_key=\" + XKit.extensions.postarchive.apiKey + \"&id=\" + post_id;\r\n\r\n\t\tGM_xmlhttpRequest({\r\n\t\t\tmethod: \"GET\",\r\n\t\t\turl: api_url,\r\n\t\t\tjson: true,\r\n\t\t\tonerror: function(response) {\r\n\t\t\t\tXKit.extensions.postarchive.show_error(\"<b>Unable to get the blog information.</b><br/>Please try again later.<br/><br/>Error Code: POA-230 <br/><br/>\"+blog_url);\r\n\t\t\t\treturn;\r\n\t\t\t},\r\n\t\t\tonload: function(response) {\r\n\r\n\t\t\t\ttry {\r\n\r\n\t\t\t\t\tdata = JSON.parse(response.responseText).response;\r\n\r\n\t\t\t\t\tvar m_object = new Object();\r\n\r\n\t\t\t\t\tm_object.title = title;\r\n\r\n\t\t\t\t\tif (XKit.browser().firefox === true) {\r\n\t\t\t\t\t\t// Firefox is a fucking bitch.\r\n\t\t\t\t\t\tm_object.post = \"XKIT-BTOA!!\" + window.btoa(unescape(encodeURIComponent(JSON.stringify(data.posts[0]))));\r\n\t\t\t\t\t\t// alert(\"tosave: \" + m_object.post);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tm_object.post = JSON.stringify(data.posts[0]);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tm_object.post_id = post_id;\r\n\t\t\t\t\tm_object.date = new Date().getTime();\r\n\t\t\t\t\tm_object.category = m_category;\r\n\r\n\t\t\t\t\tconsole.log(\"Fetched contents, trying to save...\");\r\n\r\n\t\t\t\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\t\t\t\tsetTimeout(function() {\r\n\r\n\t\t\t\t\t\tXKit.extensions.postarchive.archived_posts.push(m_object);\r\n\t\t\t\t\t\tconsole.log(XKit.extensions.postarchive.archived_posts);\r\n\t\t\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\r\n\t\t\t\t\t\tif (!in_blog_mode) {\r\n\r\n\t\t\t\t\t\t\tXKit.interface.completed_control_button(obj, true);\r\n\t\t\t\t\t\t\tXKit.notifications.add(\"Post added to Archive.\", \"ok\");\r\n\t\t\t\t\t\t\tXKit.extensions.postarchive.update_sidebar();\r\n\t\t\t\t\t\t\tXKit.window.close();\r\n\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t$(obj).addClass(\"xkit-post-archive-inblog-button-done\");\r\n\t\t\t\t\t\t\tXKit.window.close();\r\n\t\t\t\t\t\t\tsetTimeout(function() { XKit.iframe.restore();\t}, 300);\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}, 1);\r\n\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\tXKit.extensions.postarchive.show_error(\"<b>Unable to read JSON received from API calls.</b><br/>Please try again later.<br/><br/>Error Code: POS-535<br>\" + e.message);\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tdo: function() {\r\n\r\n\t\tvar posts = XKit.interface.get_posts(\"xkit-postarchive-done\");\r\n\r\n\t\t$(posts).each(function() {\r\n\r\n\t\t\t$(this).addClass(\"xkit-postarchive-done\");\r\n\r\n\t  \t\tvar m_post = XKit.interface.post($(this));\r\n\r\n\t\t\tXKit.interface.add_control_button(this, \"xkit-postarchive\", \"data-xkit-postarchive-tumblelog-key=\\\"\" + m_post.tumblelog_key + \"\\\" data-xkit-postarchive-tumblelog-name=\\\"\" + m_post.owner + \"\\\"\");\r\n\r\n\t\t\tif (XKit.extensions.postarchive.is_post_in_archive(m_post.id)) {\r\n\r\n\t\t\t\tXKit.interface.completed_control_button($(this).find(\".xkit-interface-control-button.xkit-postarchive\"), true);\r\n\r\n\t\t\t}\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tshow_error: function(message) {\r\n\r\n\t\tXKit.window.show(\"Post Archiver encountered an error\", message, \"error\", \"<div class=\\\"xkit-button default\\\" id=\\\"xkit-close-message\\\">OK</div>\");\r\n\r\n\t},\r\n\r\n\tcpanel: function(m_div) {\r\n\r\n\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\tif ($(\"#xkit-postarchive-custom-panel\").length > 0) {\r\n\t\t\t// Panel already exists, probably in refresh mode.\r\n\t\t\t// Remove it first.\r\n\t\t\t$(\"#xkit-postarchive-custom-panel\").remove();\r\n\t\t}\r\n\r\n\t\tvar cat_list = \"\";\r\n\r\n\t\tif (XKit.extensions.postarchive.categories.length === 0) {\r\n\t\t\tcat_list = \"<div class=\\\"xkit-postarchive-no-categories\\\">You have no categories set.</div>\";\r\n\t\t} else {\r\n\r\n\t\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\t\tcat_list = cat_list + \"<div class=\\\"xkit-postarchive-cp-item\\\" data-id=\\\"\" + XKit.extensions.postarchive.categories[i].id + \"\\\">\" + XKit.extensions.postarchive.categories[i].title + \"</div>\";\r\n\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tvar m_html = \t\"<div id=\\\"xkit-postarchive-custom-panel\\\">\" +\r\n\t\t\t\t\t\"<div id=\\\"xkit-postarchive-custom-panel-toolbar\\\">\" +\r\n\t\t\t\t\t\t\"<div id=\\\"xkit-postarchive-add-category\\\" class=\\\"xkit-button\\\">Add new category</div>\" +\r\n\t\t\t\t\t\"</div>\" +\r\n\t\t\t\t\tcat_list +\r\n\t\t\t\t\"</div>\";\r\n\r\n\t\t$(m_div).html(m_html);\r\n\r\n\t\t$(\"#xkit-extensions-panel-right\").nanoScroller();\r\n\t\t$(\"#xkit-extensions-panel-right\").nanoScroller({ scroll: 'top' });\r\n\r\n\t\t$(\"#xkit-postarchive-add-category\").click(function() {\r\n\r\n\t\t\tXKit.window.show(\"New category\",\"<b>Category Name:</b><input type=\\\"text\\\" maxlength=\\\"40\\\" placeholder=\\\"eg: Recipes\\\" class=\\\"xkit-textbox\\\" id=\\\"xkit-postarchive-category-add-title\\\">\",\"question\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-create-category\\\">Create Category</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\");\r\n\r\n\t\t\t$(\"#xkit-postarchive-create-category\").click(function() {\r\n\r\n\t\t\t\tvar m_title = $(\"#xkit-postarchive-category-add-title\").val();\r\n\r\n\t\t\t\tif ($.trim(m_title) === \"\") { XKit.window.close(); return; }\r\n\r\n\t\t\t\tif (XKit.extensions.postarchive.category_exists(m_title)) {\r\n\t\t\t\t\talert(\"A category with this name already exists.\");\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar m_obj = {};\r\n\t\t\t\tm_obj.id = XKit.tools.random_string() + new Date().getTime();\r\n\t\t\t\tm_obj.title = m_title;\r\n\r\n\t\t\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\t\t\tXKit.extensions.postarchive.categories.push(m_obj);\r\n\r\n\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\t\t\t\tXKit.extensions.postarchive.cpanel(m_div);\r\n\t\t\t\tXKit.window.close();\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t\t$(\".xkit-postarchive-cp-item\").click(function() {\r\n\r\n\t\t\tvar m_cat_obj = XKit.extensions.postarchive.get_category($(this).attr('data-id'));\r\n\r\n\t\t\tif (m_cat_obj === false) { alert(\"Unknown error PAS-30\"); return; }\r\n\r\n\t\t\tXKit.window.show(\"Edit category\",\"<b>Category Name:</b><input type=\\\"text\\\" maxlength=\\\"40\\\" placeholder=\\\"eg: Recipes\\\" class=\\\"xkit-textbox\\\" id=\\\"xkit-postarchive-category-add-title\\\" value=\\\"\" + m_cat_obj.title + \"\\\"><br/>If you delete this category, items saved in this category will be marked \\\"Uncategorized.\\\"\",\"question\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-save-category\\\">Save Category</div><div class=\\\"xkit-button\\\" id=\\\"xkit-postarchive-delete-category\\\">Delete</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\");\r\n\r\n\t\t\t$(\"#xkit-postarchive-save-category\").click(function() {\r\n\r\n\t\t\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\t\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\t\t\tif (m_cat_obj.id === XKit.extensions.postarchive.categories[i].id) {\r\n\r\n\t\t\t\t\t\tXKit.extensions.postarchive.categories[i].title = $(\"#xkit-postarchive-category-add-title\").val();\r\n\t\t\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\r\n\t\t\t\t\t\tXKit.window.close();\r\n\r\n\t\t\t\t\t\tXKit.extensions.postarchive.cpanel(m_div);\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#xkit-postarchive-delete-category\").click(function() {\r\n\r\n\t\t\t\tXKit.window.show(\"You sure?\",\"Delete category <b>\\\"\" + m_cat_obj.title + \"\\\"</b>?\",\"warning\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-postarchive-delete-category-confirm\\\">Confirm</div><div class=\\\"xkit-button\\\" id=\\\"xkit-close-message\\\">Cancel</div>\");\r\n\r\n\t\t\t\t$(\"#xkit-postarchive-delete-category-confirm\").click(function() {\r\n\r\n\t\t\t\t\tXKit.extensions.postarchive.load_posts();\r\n\r\n\t\t\t\t\tfor (var i=0;i<XKit.extensions.postarchive.archived_posts.length;i++) {\r\n\r\n\t\t\t\t\t\tif (typeof XKit.extensions.postarchive.archived_posts[i].category !== \"undefined\") {\r\n\r\n\t\t\t\t\t\t\tif (XKit.extensions.postarchive.archived_posts[i].category === m_cat_obj.id) {\r\n\r\n\t\t\t\t\t\t\t\tXKit.extensions.postarchive.archived_posts[i].category = \"\";\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\t\t\t\tif (m_cat_obj.id === XKit.extensions.postarchive.categories[i].id) {\r\n\r\n\t\t\t\t\t\t\tXKit.extensions.postarchive.categories.splice(i, 1);\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tXKit.extensions.postarchive.save_posts();\r\n\t\t\t\t\tXKit.extensions.postarchive.cpanel(m_div);\r\n\t\t\t\t\tXKit.window.close();\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t});\r\n\r\n\t\t});\r\n\r\n\t},\r\n\r\n\tget_category: function(id) {\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\tif (id === XKit.extensions.postarchive.categories[i].id) {\r\n\r\n\t\t\t\treturn XKit.extensions.postarchive.categories[i];\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tcategory_exists: function(title) {\r\n\r\n\t\ttitle = title.toLowerCase();\r\n\r\n\t\tfor (var i=0;i<XKit.extensions.postarchive.categories.length;i++) {\r\n\r\n\t\t\tif (title === XKit.extensions.postarchive.categories[i].title.toLowerCase()) {\r\n\r\n\t\t\t\treturn true;\r\n\r\n\t\t\t}\r\n\r\n\t\t}\r\n\r\n\t\treturn false;\r\n\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\tthis.running = false;\r\n\t\t$(\"#postarchive_ul\").remove();\r\n\t\tXKit.post_listener.remove(\"postarchive\");\r\n\r\n\r\n\t}\r\n\r\n});\r\n","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAIAAAAlC+aJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpGNzdGMTE3NDA3MjA2ODExODA4MzkyMjM2MzU5MTQ4NCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4QzczNEU1QzcyODYxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4QzczNEU1QjcyODYxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjAxODAxMTc0MDcyMDY4MTFBRTczREVDNEM5OEM0RTE5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkY3N0YxMTc0MDcyMDY4MTE4MDgzOTIyMzYzNTkxNDg0Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+yjqFuwAAAuNJREFUeNrsWs1vEkEUfzPgB0a82AMno1e1J2ts/KgXjT2YeJGbp95MvBhNPGg8+HXQePBg/CO0xmBIRI3btCYWLY0eCC0fIZFdjCgUkEJhC+u0NOkHdDu7O+1kmnn5nRaW9377fm/evGHR9bcgtGEASYCruRGSGeCbAZAZkBmQRSwzsGRPLhg0XxuO+sfVV+wI8HhsiGUGeETPkgCHVQgZDJ1uAwltOQPiESGhCQBbAlJCvCUk+wDnPiB+EfNoZGLXgPASAtnIOA80bJ8YejBipxNdPvLSt7dvzfV9uw7S3F6bz+vNf2suvokdypS2rIgN+JTyDx0r73R5bdztce8nWHnlq3pfLdnMDG43dquYmYPg9HkmGtDKYyPpu/bCIMC275zOhyPZxw6jJ3IKTA20ADgQIFDSt3KzE04IBOMnyw1wEgPGiyuRPRgGBGLHGx0VSWlh9U66EHcSAAZnGSAo1iGUOGdL+srnnw8deidwDQ4t9XbbKNQ0z449Pu8p+uirem442qs3nbomwE4zuIgxUgyVMD2Bd/Gj1QYwcY2dJ5GgtVCO/fVmkUr6mZuZ0h8mfp0W8UpU5uBj4vSG0aul0Df1KSunzDLQRnom+v3XPZPoZ/Xs+8QgADB0ip5/Ybm1ciG4dHjU5z3TZf9hNAMxj1bWWZ9Or//Z1f5Vp80vxjferbQM+JAc8Pf+3b16t0NsQruRLeuUGx561xgvdOPu6Ng2UYEsL0rqRIf0g5PaM8pfsOp63SW26yhIg0wx9SN7e1n6jYySumhpdad3bbYKdc4+9Iioj3KV0bb0leSBum7tdguuTQq864kaJYiEleTZ+nw+ol77XbG8ttC7dtPPlFanT1IMoamefJXB2IqZDPU2JvFCjc38bvIjFkZKjv/HmrjeRAkxNG4SYngizyADV/oMsTPA0UwzIAIBvK0JgAgETNT1ehKENuHfF3KL/sKQ+ASElxACSUAS2KQWIYb9F2AArvzPhmFrSFwAAAAASUVORK5CYII=","css":"#xkit-postarchive-background {\r\n\r\n\tposition: fixed;\r\n\ttop: 0; left: 0;\r\n\tbackground: rgba(0,0,0,0.67);\r\n\twidth: 100%;\r\n\tz-index: 100000;\r\n\theight: 100%;\r\n\r\n}\r\n\r\n.xkit-post-archive-avatar {\r\n\twidth: 12px;\r\n\theight: 12px;\r\n\t/* margin-left: 8px; */\r\n\tmargin-right: 7px;\r\n\tvertical-align: middle;\r\n\tborder-radius: 3px;\r\n\tdisplay: inline-block;\r\n\tmargin-bottom: 3px;\r\n}\r\n\r\n.xkit-postarchive-post-not-supported {\r\n\tborder: 1px dashed rgb(200,200,200);\r\n\ttext-align: center;\r\n\tcolor: rgb(140,140,140);\r\n\theight: 200px;\r\n\tline-height: 200px;\r\n}\r\n\r\n#postarchive_view:after {\r\n\tbackground: no-repeat 0px 45% url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABMAAAATCAYAAAByUDbMAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OEM3MzRFNUY3Mjg2MTFFMzkxNjc4NTlFOTA5MTY1RjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OEM3MzRFNjA3Mjg2MTFFMzkxNjc4NTlFOTA5MTY1RjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4QzczNEU1RDcyODYxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4QzczNEU1RTcyODYxMUUzOTE2Nzg1OUU5MDkxNjVGNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PnWNT5cAAADASURBVHjaYmRAA////0fmZjNggqtAfADGYWRkhEswMVARjBDDGLFEgBWQ4oZy1bDo+QjEL6Hs68AIeAKTYMGi+D4QB2KzCAr4ofg5ED8l5E2QohMEfPQdiHeCPEJMmJ0D4od4DNsNxF9JiYA9QPwZi/hpIH5Mamz+AOJdQPwXSewJ1DDssQmMPeQsMxWLGgMgtgbib0C8EkpjzXIsRCSfC0AsCcSXsRiEAliITI/b6Z4DWHD5f5hldLSSlSIAEGAAoNcs9y8b6dQAAAAASUVORK5CYII=) !important;\r\n\tcontent: \"\\54\";\r\n\tfont-size: 0;\r\n\tline-height: 37px;\r\n\twidth: 20px;\r\n}\r\n\r\n.xkit-postarchive-cat-separator {\r\n\tborder-bottom: 1px solid rgb(200,200,200);\r\n\theight: 26px;\r\n\tline-height: 26px;\r\n\tbackground: #f4ffe8 no-repeat 5px 50% url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAACZ3F9/AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTQ0NUQ3NjQ3Mjg4MTFFMzkxNjc4NTlFOTA5MTY1RjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjlFNzM3RTg3MzM1MTFFMzkxNjc4NTlFOTA5MTY1RjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5NDQ1RDc2MjcyODgxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5NDQ1RDc2MzcyODgxMUUzOTE2Nzg1OUU5MDkxNjVGNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Psb/oUAAAABhSURBVHjaYvr//z8DOZiFAQ1EdjD+B1KM6OLLK/6j8JkYsIP/DAQAEx65/+RqxKuZkEacmonRiFUzURqBIZpOskaQJmAUzSJJIy5NeDXi04RTIyFNkODCTIdpxKRVgAADALDQb7Gw7aKlAAAAAElFTkSuQmCC');\r\n\ttext-align: center;\r\n\tfont-size: 13px;\r\n\tfont-weight: bold;\r\n\tcolor: #55871e;\r\n\ttext-shadow: 0px 1px 0px white;\r\n\tposition: relative;\r\n\tcursor: pointer;\r\n}\r\n\r\n.xkit-postarchive-hidden-category-item {\r\n\r\n\tdisplay: none;\r\n\r\n}\r\n\r\n.xkit-postarchive-cat-separator.xkit-pac-opened {\r\n\r\n\tbackground-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAANCAYAAACZ3F9/AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MjlFNzM3RUI3MzM1MTFFMzkxNjc4NTlFOTA5MTY1RjciIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MjlFNzM3RUM3MzM1MTFFMzkxNjc4NTlFOTA5MTY1RjciPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDoyOUU3MzdFOTczMzUxMUUzOTE2Nzg1OUU5MDkxNjVGNyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoyOUU3MzdFQTczMzUxMUUzOTE2Nzg1OUU5MDkxNjVGNyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PrxkghcAAABbSURBVHjaYvz//z8DOYCJgUxAf40sICKyg5Fojy6v+M8ItxHISSdSUzqKU4E2ziKkGSQPUofhR3ya0TVhBA42zdg0YQ1VZM24NIEBKOXgwGl45BgY6Z7kAAIMAKBeWWFB0YUEAAAAAElFTkSuQmCC');\r\n\r\n}\r\n\r\n.xkit-postarchive-cat-separator:hover {\r\n\r\n\tbackground-color: #e6f0da;\r\n\r\n}\r\n\r\n.xkit-postarchive-cat-separator-title {\r\n\r\n\tposition: absolute;\r\n\ttop: 0; left: 22px;\r\n\ttext-align: left;\r\n\twidth: 195px;\r\n\r\n}\r\n\r\n.xkit-postarchive-no-posts-index {\r\n\tfont-size: 12px;\r\n\tpadding: 5px;\r\n\ttext-align: center;\r\n\tborder-bottom: 1px solid rgb(200,200,200);\r\n\tcolor: rgb(130,130,130);\r\n}\r\n\r\n.xkit-postarchive-cp-item {\r\n\tpadding: 10px 16px 10px 16px;\r\n\tborder-bottom: 1px dotted rgb(190,190,190);\r\n\tcursor: pointer;\r\n}\r\n\r\n.xkit-postarchive-cp-item:hover {\r\n\tbackground: rgb(240,240,240);\r\n}\r\n\r\n#xkit-postarchive-category {\r\n\twidth: 100%;\r\n\theight: 28px;\r\n\tmargin-top: 5px;\r\n}\r\n\r\n.xkit-postarchive-no-categories {\r\n\ttext-align: center;\r\n\tpadding-top: 20px;\r\n\tcolor: rgb(140,140,140);\r\n\tfont-size: 14px;\r\n}\r\n\r\n#xkit-postarchive-custom-panel-toolbar {\r\n\tbackground: rgb(245,245,245);\r\n\tpadding: 3px 15px;\r\n\tborder-bottom: 1px solid rgb(190,190,190);\r\n}\r\n\r\n#xkit-postarchive-rename-this.hidden,\r\n#xkit-postarchive-remove-this.hidden,\r\n#xkit-postarchive-recategorize-this.hidden { display: none; }\r\n\r\n#xkit-postarchive-remove-this {\r\n\tposition: absolute;\r\n\ttop: 0px;\r\n\tleft: -91px;\r\n\twidth: 80px;\r\n\tfont-size: 11px;\r\n\ttext-align: center;\r\n\theight: 30px;\r\n\tline-height: 30px;\r\n\tborder-radius: 4px;\r\n\tcursor: pointer;\r\n\tpadding: 0;\r\n}\r\n\r\n#xkit-postarchive-recategorize-this {\r\n\tposition: absolute;\r\n\ttop: 36px;\r\n\tleft: -91px;\r\n\twidth: 80px;\r\n\tfont-size: 11px;\r\n\ttext-align: center;\r\n\theight: 30px;\r\n\tline-height: 30px;\r\n\tborder-radius: 4px;\r\n\tcursor: pointer;\r\n\tpadding: 0;\r\n}\r\n\r\n#xkit-postarchive-rename-this {\r\n\tposition: absolute;\r\n\ttop: 72px;\r\n\tleft: -91px;\r\n\twidth: 80px;\r\n\tfont-size: 11px;\r\n\ttext-align: center;\r\n\theight: 30px;\r\n\tline-height: 30px;\r\n\tborder-radius: 4px;\r\n\tcursor: pointer;\r\n\tpadding: 0;\r\n}\r\n\r\n#xkit-postarchive-container {\r\n\r\n\tposition: absolute;\r\n\ttop: 91px; left: 50%;\r\n\twidth: 800px;\r\n\tmargin-left: -346px;\r\n\tz-index: 200000;\r\n\r\n}\r\n\r\n#xkit-postarchive-search {\r\n\r\n\tposition: absolute;\r\n\tright: 16px;\r\n\ttop: 275px;\r\n\twidth: 230px;\r\n\tborder: 0px;\r\n\theight: 29px;\r\n\tpadding: 5px 10px 5px 30px;\r\n\tbox-sizing: border-box;\r\n\t-webkit-box-sizing: border-box;\r\n\t-moz-box-sizing: border-box;\r\n\tborder-radius: 6px;\r\n\tbackground: white no-repeat 10px 50% url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAANCAYAAABy6+R8AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QjMxRTZFMEZBODY4MTFFMkFDMDJFMzk3N0RDMDc2NDQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QjMxRTZFMTBBODY4MTFFMkFDMDJFMzk3N0RDMDc2NDQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpCMzFFNkUwREE4NjgxMUUyQUMwMkUzOTc3REMwNzY0NCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpCMzFFNkUwRUE4NjgxMUUyQUMwMkUzOTc3REMwNzY0NCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pnjwe50AAADhSURBVHjalJExEoIwEEVDvAAdpUeQhhk7OQKeAO2k4wh6AztK4w04AvYUUNp5BDwB/sz8MGsGh/HP/MmyyctulmAcR2VVVdUOSwnHcAg38LUoiofyFFgIQI7YqHkZgEeZWEVRZCvU8ACfcGCfJMmlbVtbKYO3iDvkng7SbMmqBHB3G2wr4+dZVtJ8g5KAB3bujIRC9ac0p+Sm9yXkNqzy8iE3tVqCiNdiz8yN/Ib4wFzHVb7DTjbFG/sJ4s25+LmKLRnmQglO0C/xXY0AY700KbaUErDVh8VK3mAGXPL+CDAAWp9eZGKACQQAAAAASUVORK5CYII=);\r\n\r\n}\r\n\r\n#xkit-postarchive-export {\r\n\r\n\tposition: absolute;\r\n\tright: 12px;\r\n\ttop: 310px;\r\n\twidth: 230px;\r\n\tborder: 0px;\r\n\theight: 29px;\r\n\tpadding: 5px 10px 5px 30px;\r\n\tbox-sizing: border-box;\r\n\t-webkit-box-sizing: border-box;\r\n\t-moz-box-sizing: border-box;\r\n\tborder-radius: 6px;\r\n\tbackground: white;\r\n\r\n}\r\n\r\n#xkit-postarchive-import {\r\n\r\n\tposition: absolute;\r\n\tright: 12px;\r\n\ttop: 350px;\r\n\twidth: 230px;\r\n\tborder: 0px;\r\n\theight: 29px;\r\n\tpadding: 5px 10px 5px 30px;\r\n\tbox-sizing: border-box;\r\n\t-webkit-box-sizing: border-box;\r\n\t-moz-box-sizing: border-box;\r\n\tborder-radius: 6px;\r\n\tbackground: white;\r\n\r\n}\r\n\r\n#xkit-postarchive-share-code {\r\n\r\n\theight: 203px;\r\n\tborder: 1px solid rgb(190,190,190);\r\n\tmargin-top: 10px;\r\n\tbackground: rgb(244,244,244);\r\n\r\n}\r\n\r\n#xkit-postarchive-share-code-inner {\r\n\r\n\tfont-family: \"Courier New\", Courier, monospace;\r\n\tfont-size: 14px;\r\n\tbackground: rgb(244,244,244);\r\n\tpadding: 15px;\r\n\tword-wrap: break-word;\r\n\t-moz-user-select: text !important;\r\n\t-webkit-user-select: text !important;\r\n\tuser-select: text !important;\r\n\r\n}\r\n\r\n#xkit-postarchive-sidebar {\r\n\r\n\twidth: 230px;\r\n\theight: 265px;\r\n\tbackground: rgb(255,255,255);\r\n\tborder-radius: 6px;\r\n\tbox-shadow: 0px 1px 3px rgba(0,0,0,0.44);\r\n\tposition: absolute;\r\n\ttop: 0; right: 16px;\r\n\toverflow: hidden;\r\n\r\n}\r\n\r\n#xkit-postarchive-sidebar * {\r\n\r\n  \t-moz-user-select: none;\r\n  \t-webkit-user-select: none;\r\n  \t-ms-user-select: none;\r\n\r\n}\r\n\r\n#xkit-postarchive-content {\r\n\r\n\tposition: absolute;\r\n\ttop: 0; left: 0px;\r\n\r\n}\r\n\r\n#xkit-postarchive-content.xkit-postarchive-no-post-selected {\r\n\r\n\tbackground: rgba(245,245,245,0.22);\r\n\twidth: 540px;\r\n\tborder-radius: 6px;\r\n\tpadding: 170px 0px;\r\n\ttext-align: center;\r\n\tcolor: white;\r\n\tborder: 1px dashed white;\r\n\ttext-shadow: 0px -1px 0px black;\r\n\r\n}\r\n\r\n#xkit-postarchive-not-found {\r\n\ttext-align: center;\r\n\tpadding-top: 120px;\r\n\tcolor: rgb(140,140,140);\r\n}\r\n\r\n.xkit-postarchive-fix-margins {\r\n\r\n\tpadding: 0 !important; margin: 0 !important;\r\n\r\n}\r\n\r\n#xkit-postarchive-sidebar .xkit-postarchive-post.xkit-this-post-is-pretty-hidden,\r\n.xkit-postarchive-cat-separator.xkit-this-post-is-pretty-hidden,\r\n.xkit-postarchive-no-posts-index.xkit-this-post-is-pretty-hidden { display: none; }\r\n\r\n#xkit-postarchive-sidebar .xkit-postarchive-post {\r\n\r\n\tpadding: 6px 11px;\r\n\tborder-bottom: 1px solid rgb(210,210,210);\r\n\tfont-size: 13px;\r\n\tcursor: pointer;\r\n\tcolor: rgb(90,90,90);\r\n\r\n\ttext-overflow:ellipsis;\r\n\twhite-space:nowrap;\r\n\toverflow: hidden;\r\n\r\n}\r\n\r\n\r\n\r\n#xkit-postarchive-sidebar .xkit-postarchive-post:hover {\r\n\r\n\tcolor: black;\r\n\tbackground: rgb(240,240,240);\r\n\r\n}\r\n\r\n#xkit-postarchive-sidebar .xkit-postarchive-post.selected {\r\n\r\n\tcolor: black !important;\r\n\tbackground: rgb(220,220,220) !important;\r\n\tbox-shadow: inset 0px 1px 2px rgba(0,0,0,0.22);\r\n\r\n}\r\n\r\n#postarchive_view {\r\n  color: rgba(255, 255, 255, 0.5);\r\n}\r\n","title":"Post Archiver","description":"Never lose a post again.","developer":"STUDIOXENIX","version":"0.5.1","frame":"false","beta":"false","details":"Post Archiver lets you save posts to your XKit.<br><br>Found a good recipe? Think those hotline numbers on that signal boost post might come in handy in the future?<br><br>Click on the save button, then click on the My Archive button on your sidebar anytime to access those posts. You can also name and categorize posts.","file":"found","server":"up","errors":false,"slow":"false"}