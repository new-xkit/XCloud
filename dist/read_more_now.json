{"id":"read_more_now","script":"//* TITLE Read More Now **//\r\n//* VERSION 1.4.0 **//\r\n//* DESCRIPTION Read Mores in your dash **//\r\n//* DETAILS This extension allows you to read 'Read More' posts without leaving your dash. Just click on the 'Read More Now!' button on posts and XKit will automatically load and display the post on your dashboard. **//\r\n//* DEVELOPER STUDIOXENIX **//\r\n//* FRAME false **//\r\n//* BETA false **//\r\n\r\nXKit.extensions.read_more_now = new Object({\r\n\r\n\trunning: false,\r\n\tbutton_caption: \"Read More Now!\",\r\n\tapiKey: XKit.api_key, //*\"fuiKNFp9vQFvjLNvx4sUwti4Yb5yGutBN4Xh10LXZhhRKjWlV4\",**//\r\n\r\n\tpreferences: {\r\n\t\tauto_open: {\r\n\t\t\ttext: \"Auto-open all Read More posts (not recommended)\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\tinline_button: {\r\n\t\t\ttext: \"Show a smaller, inline button for Read More Now\",\r\n\t\t\tdefault: false,\r\n\t\t\tvalue: false\r\n\t\t},\r\n\t\tprocess_keep_reading: {\r\n\t\t\ttext: \"Show Read More Now for Keep Reading links\",\r\n\t\t\tdefault: true,\r\n\t\t\tvalue: true\r\n\t\t}\r\n\t},\r\n\r\n\trun: function() {\r\n\t\tthis.running = true;\r\n\r\n\t\tif (XKit.interface.where().queue === true || XKit.interface.where().drafts === true) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tXKit.post_listener.add(\"read_more_now\", XKit.extensions.read_more_now.do);\r\n\t\tXKit.extensions.read_more_now.do();\r\n\t\t$(document).on('click', '.xkit-read-more-now', function() {\r\n\t\t\t$(this).addClass(\"disabled\");\r\n\t\t\t$(this).html(\"Retrieving post...\");\r\n\t\t\tvar m_url = $(this).attr('data-post-url');\r\n\t\t\tvar json_page_parts = m_url.replace(\"http://\",\"\").split(\"/\");\r\n\t\t\tvar blog_name = json_page_parts[0];\r\n\t\t\tvar post_id = json_page_parts[2];\r\n\t\t\tvar m_cont = $(this);\r\n\r\n\t\t\tvar api_url = \"https://api.tumblr.com/v2/blog/\" + blog_name + \"/posts\" + \"?api_key=\" + XKit.extensions.read_more_now.apiKey + \"&id=\" + post_id;\r\n\r\n\t\t\tGM_xmlhttpRequest({\r\n\t\t\t\tmethod: \"GET\",\r\n\t\t\t\turl: api_url,\r\n\t\t\t\tjson: true,\r\n\t\t\tonerror: function() {\r\n\t\t\t\t$(m_cont).removeClass(\"disabled\");\r\n\t\t\t\t$(m_cont).html(XKit.extensions.read_more_now.button_caption);\r\n\t\t\t\tXKit.extensions.read_more_now.show_failed();\r\n\t\t\t},\r\n\t\t\tonload: function(response) {\r\n\t\t\t\tvar data = JSON.parse(response.responseText);\r\n\t\t\t\tvar m_object = data.response;\r\n\t\t\t\ttry {\r\n\t\t\t\t\tvar m_contents = m_object.posts[0].body;\r\n\r\n\t\t\t\t\tif (m_object.posts[0].type === \"photo\") {\r\n\t\t\t\t\t\tm_contents = m_object.posts[0][\"photo-caption\"] ||\r\n\t\t\t\t\t\t             m_object.posts[0].caption;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (m_object.posts[0].type === \"answer\") {\r\n\t\t\t\t\t\tm_contents = m_object.posts[0].answer;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (m_object.posts[0].type === \"link\") {\r\n\t\t\t\t\t\tm_contents = m_object.posts[0].description;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif ($(m_cont).parent().parent().find(\".post_title\").length > 0) {\r\n\t\t\t\t\t\tvar post_title = $(m_cont).parent().parent().find(\".post_title\")[0].outerHTML;\r\n\t\t\t\t\t\t$(m_cont).parent().parent().html(XKit.extensions.read_more_now.strip_scripts(post_title + m_contents));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(m_cont).parent().parent().html(XKit.extensions.read_more_now.strip_scripts(m_contents));\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch(e) {\r\n\t\t\t\t\t$(m_cont).removeClass(\"disabled\");\r\n\t\t\t\t\t$(m_cont).html(XKit.extensions.read_more_now.button_caption);\r\n\t\t\t\t\tXKit.extensions.read_more_now.show_failed();\r\n\t\t\t\t}\r\n\t\t\t}});\r\n\t\t});\r\n\t},\r\n\r\n\tstrip_scripts: function(s) {\r\n\r\n\t\t/*\r\n\t\t\tFrom:\r\n\t\t\thttp://stackoverflow.com/questions/6659351/removing-all-script-tags-from-html-with-js-regular-expression\r\n\t\t*/\r\n\r\n\t\tvar div = document.createElement('div');\r\n\t\tdiv.innerHTML = s;\r\n\t\tvar scripts = div.getElementsByTagName('script');\r\n\t\tvar i = scripts.length;\r\n\t\twhile (i--) {\r\n\t\t\t\tscripts[i].parentNode.removeChild(scripts[i]);\r\n\t\t}\r\n\t\treturn div.innerHTML;\r\n\t},\r\n\r\n\tshow_failed: function() {\r\n\r\n\t\tXKit.window.show(\"Unable to fetch read more\",\"Perhaps the user deleted the post?\",\"error\",\"<div class=\\\"xkit-button default\\\" id=\\\"xkit-close-message\\\">OK</div>\");\r\n\r\n\t},\r\n\r\n\tdo: function() {\r\n\r\n\t\t$(\".post\").not(\".xread-more-now-done\").each(function() {\r\n\t\t\tvar post = $(this);\r\n\t\t\tif (post.hasClass(\"xread-more-now-done\")) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\tpost.addClass(\"xread-more-now-done\");\r\n\r\n\t\t\tif (post.hasClass(\"read_more_container\")) {\r\n\t\t\t\tXKit.extensions.read_more_now.handle_read_more_post(post);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif (XKit.extensions.read_more_now.preferences.process_keep_reading.value) {\r\n\t\t\t\tpost.find(\"a\").each(function() {\r\n\t\t\t\t\tvar a = $(this);\r\n\t\t\t\t\tif (a.text().trim() !== \"Keep reading\") {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (/https?:\\/\\/[^.]+\\.tumblr\\.com\\/post\\/\\d+/.test(a.attr(\"href\"))) {\r\n\t\t\t\t\t\tXKit.extensions.read_more_now.append_button_with_link(a.parent(), a.attr(\"href\"));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// If url is not of the form\r\n\t\t\t\t\t\t// http://something.tumblr.com/post/numbers/whatever it needs to be\r\n\t\t\t\t\t\t// determined based on the post's author\r\n\t\t\t\t\t\tvar real_prefix = 'https://' + post.attr('data-tumblelog-name') + '.tumblr.com/';\r\n\t\t\t\t\t\tvar real_link = a.attr('href').replace(/https?:\\/\\/[^\\/]+\\//, real_prefix);\r\n\t\t\t\t\t\tXKit.extensions.read_more_now.append_button_with_link(a.parent(), real_link);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t},\r\n\r\n\thandle_read_more_post: function(post) {\r\n\t\tXKit.extensions.read_more_now.append_button_with_link(post, post.find(\".read_more\").attr(\"href\"));\r\n\t},\r\n\r\n\tappend_button_with_link: function(post, url) {\r\n\t\tvar div = document.createElement(\"div\");\r\n\t\tdiv.classList.add(\"xkit-read-more-now\");\r\n\t\tdiv.classList.add(\"xkit-button\");\r\n\t\tdiv.dataset.postUrl = url;\r\n\t\tdiv.innerHTML = XKit.extensions.read_more_now.button_caption;\r\n\t\tif (XKit.extensions.read_more_now.preferences.inline_button.value === true) {\r\n\t\t\tdiv.setAttribute(\"style\", \"display: inline-block; text-align: center; margin-left: 10px; margin-top: 0; float: right;\");\r\n\t\t} else {\r\n\t\t\tdiv.setAttribute(\"style\", \"display: block; text-align: center; margin-top: 20px;\");\r\n\t\t}\r\n\t\tpost.append(div);\r\n\r\n\t\tif (XKit.extensions.read_more_now.preferences.auto_open.value === true) {\r\n\t\t\tsetTimeout(function() { $(\".xkit-read-more-now\").trigger(\"click\"); }, 250);\r\n\t\t}\r\n\t},\r\n\r\n\tdestroy: function() {\r\n\t\t$(\".xkit-read-more-now\").remove();\r\n\t\tthis.running = false;\r\n\t}\r\n\r\n});\r\n","icon":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBNYWNpbnRvc2giIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OTkyOTlCMDlCOEREMTFFMkJEMDhCREQyMUI4NEFBNzgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OTkyOTlCMEFCOEREMTFFMkJEMDhCREQyMUI4NEFBNzgiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo5OTI5OUIwN0I4REQxMUUyQkQwOEJERDIxQjg0QUE3OCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo5OTI5OUIwOEI4REQxMUUyQkQwOEJERDIxQjg0QUE3OCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PubmkWMAAAdnSURBVHjabFZriFVV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","title":"Read More Now","description":"Read Mores in your dash","developer":"STUDIOXENIX","version":"1.4.0","frame":"false","beta":"false","details":"This extension allows you to read 'Read More' posts without leaving your dash. Just click on the 'Read More Now!' button on posts and XKit will automatically load and display the post on your dashboard.","file":"found","server":"up","errors":false,"slow":"false"}